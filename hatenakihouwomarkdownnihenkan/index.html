<div style="width: 100%; text-align: center;">
  <textarea class="hatena" cols="40" rows="7" style="width: 100%;" >
  </textarea>
  <a class="button" style="border: 1px solid;cursor: pointer;margin: auto;">
    ↓変換↓
  </a>
  <textarea class="markdown" cols="40" rows="7" style="width: 100%;">
  </textarea>
</div>

<script>
document.querySelector('a.button').addEventListener('click', _ => {
  document.querySelector('.markdown').value =
    document.querySelector('.hatena').value
  // headline
    .replace(/^([\*]{1,4})/mg, () => arguments[0].replace(/\*/g, '#'))
  // blockquote
    .replace(/^\>\>\n([\s\S]*?)(\n\<\<)/mg, () => arguments[1].replace(/\n/, "\n>") && arguments[2].replace(/.*/, '\n\n<!-- -->\n'))
  // list
    .replace(/^([\-]+)\-/mg, () => `${arguments[1].replace(/\-/g,'    ')} -`)
    .replace(/^([\+]+)?\+/mg, () => `${arguments[1] ? arguments[1].replace(/\+/g,'    ') : ''}1.`)
  // link
    .replace(/\[(https?:\/\/.*?)(?:\:title=(.*?))\]/mg, () => `[${arguments[2]}](${arguments[1]})`)
    .replace(/\[(https?:\/\/.*?)(?:\:image)]/, () => `![](${arguments[1]})`)
})
</script>
